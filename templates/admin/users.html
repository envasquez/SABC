{% extends "base.html" %}
{% block title %}Manage Users - South Austin Bass Club{% endblock %}
{% block content %}
<div class="mb-4">
    <h1 class="display-5"><i class="bi bi-people me-2"></i>Manage Users</h1>
    <p class="lead text-muted">User administration</p>
</div>
<ul class="nav nav-tabs mb-3">
    {% for tab, icon, label in [('active', 'person-check', 'Active Members'), ('inactive', 'person-dash', 'Inactive Members')] %}
    <li class="nav-item">
        <a class="nav-link {{ 'active' if current_tab == tab }}" href="/admin/users?tab={{ tab }}">
            <i class="bi bi-{{ icon }} me-1"></i>{{ label }}
        </a>
    </li>
    {% endfor %}
</ul>
<table class="table table-dark table-striped">
    <thead><tr><th>Name</th><th>Email</th><th>Status</th><th>Actions</th></tr></thead>
    <tbody>
        {% for u in users %}
        <tr>
            <td class="text-white">{{ u[1] }}</td>
            <td>{{ u[2] or '-' }}</td>
            <td>
                {% if current_tab == 'inactive' %}
                    <span class="badge bg-warning text-dark">Inactive Member</span>
                {% else %}
                    <span class="badge bg-success">Active Member</span>
                    {% if u[4] %}<span class="badge bg-danger ms-1">Admin</span>{% endif %}
                {% endif %}
            </td>
            <td>
                <div class="btn-group btn-group-sm">
                    {% if current_tab == 'inactive' %}
                        <button class="btn btn-success" onclick="if(confirm('Activate this member?'))fetch('/admin/users/{{ u[0] }}/activate',{method:'POST'}).then(()=>location.reload())"><i class="bi bi-person-check"></i> Activate</button>
                    {% endif %}
                    <button class="btn btn-warning" onclick="location='/admin/users/{{ u[0] }}/edit'"><i class="bi bi-pencil"></i></button>
                    <button class="btn btn-danger" {{ 'disabled' if u[0] == user.id else "onclick=\"if(confirm('Deactivate user?'))fetch('/admin/users/" + u[0]|string + "',{method:'DELETE'}).then(()=>location.reload())\"" }}><i class="bi bi-person-x"></i></button>
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% if not users %}<div class="alert alert-info">No users found.</div>{% endif %}
{% endblock %}