<!-- Reusable events table for tabs -->
<div class="table-responsive">
    <table class="table table-hover mb-0">
        <thead>
            <tr>
                <th width="15%">Date</th>
                <th width="15%">Name</th>
                <th width="20%">Description</th>
                {% if sabc_events|selectattr('event_type', 'equalto', 'sabc_tournament')|list %}
                <th width="10%">Times</th>
                <th width="8%">Fee</th>
                <th width="12%">Poll Status</th>
                <th width="12%">Tournament</th>
                {% elif sabc_events|selectattr('event_type', 'equalto', 'holiday')|list %}
                <th width="20%">Holiday</th>
                <th width="20%">Details</th>
                {% else %}
                <th width="15%">Type</th>
                <th width="15%">Status</th>
                {% endif %}
                <th width="8%" class="text-end">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for event in sabc_events %}
            <tr>
                <td>
                    <strong>{{ event.date }}</strong>
                    <br><small class="text-muted">{{ event.day_name }}</small>
                </td>
                <td><strong>{{ event.name }}</strong></td>
                <td>{{ event.description }}</td>
                
                {% if event.event_type == 'sabc_tournament' %}
                <td>
                    {% if event.start_time %}
                    <small class="text-muted">Start:</small> {{ event.start_time }}<br>
                    {% endif %}
                    {% if event.weigh_in_time %}
                    <small class="text-muted">Weigh:</small> {{ event.weigh_in_time }}
                    {% endif %}
                </td>
                <td>
                    {% if event.entry_fee %}
                    ${{ "%.2f"|format(event.entry_fee) }}
                    {% else %}
                    <span class="text-muted">-</span>
                    {% endif %}
                </td>
                <td>
                    {% if event.has_poll %}
                        {% if event.poll_active %}
                            <span class="badge bg-warning">
                                <i class="bi bi-clock-history me-1"></i>Active
                            </span>
                        {% else %}
                            <span class="badge bg-success">
                                <i class="bi bi-check-circle me-1"></i>Closed
                            </span>
                        {% endif %}
                    {% else %}
                        <a href="/admin/polls/create?event_id={{ event.id }}" class="btn btn-sm btn-outline-primary">
                            <i class="bi bi-plus"></i> Create
                        </a>
                    {% endif %}
                </td>
                <td>
                    {% if event.has_tournament %}
                        {% if event.tournament_complete %}
                            <span class="badge bg-success">
                                <i class="bi bi-check-circle me-1"></i>Complete
                            </span>
                        {% else %}
                            <span class="badge bg-warning">
                                <i class="bi bi-clock me-1"></i>Upcoming
                            </span>
                        {% endif %}
                    {% else %}
                        <span class="badge bg-secondary">
                            <i class="bi bi-calendar-plus me-1"></i>Not Created
                        </span>
                    {% endif %}
                </td>
                
                {% elif event.event_type == 'holiday' %}
                <td>
                    <span class="badge bg-info">
                        <i class="bi bi-calendar-heart me-1"></i>{{ event.holiday_name or event.name }}
                    </span>
                </td>
                <td>
                    <small class="text-muted">Holiday</small>
                    {% if event.description %}
                    <br>{{ event.description }}
                    {% endif %}
                </td>
                
                {% else %}
                <td>
                    {% if event.event_type == 'other_tournament' %}
                        <span class="badge bg-warning"><i class="bi bi-calendar"></i> Tournament</span>
                    {% elif event.event_type == 'club_event' %}
                        <span class="badge bg-secondary"><i class="bi bi-calendar-event"></i> Club Event</span>
                    {% else %}
                        <span class="badge bg-light text-dark">{{ event.event_type }}</span>
                    {% endif %}
                </td>
                <td>
                        <span class="badge bg-success">Scheduled</span>
                </td>
                {% endif %}
                
                <td class="text-end">
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-warning edit-event-btn" 
                                data-event-id="{{ event.id }}"
                                data-event-date="{{ event.date }}"
                                data-event-type="{{ event.event_type }}"
                                data-event-name="{{ event.name }}"
                                data-event-description="{{ event.description }}"
                                data-start-time="{{ event.start_time or '' }}"
                                data-weigh-in-time="{{ event.weigh_in_time or '' }}"
                                data-lake-name="{{ event.lake_name or '' }}"
                                data-ramp-name="{{ event.ramp_name or '' }}"
                                data-entry-fee="{{ event.entry_fee or 25.00 }}"
                                data-fish-limit="{{ event.fish_limit or 5 }}"
                                data-holiday-name="{{ event.holiday_name or '' }}"
                                data-has-poll="{{ event.has_poll|tojson }}"
                                data-poll-active="{{ event.poll_active|tojson }}">
                            <i class="bi bi-pencil"></i>
                        </button>
                        <button class="btn btn-danger" onclick="deleteEvent({{ event.id }}, {{ (event.has_poll or event.has_tournament)|tojson }}, '{{ event.name|replace("'", "\\'") }}')">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
            {% endfor %}
            
            {% if not sabc_events %}
            <tr>
                <td colspan="8" class="text-center text-muted py-4">
                    {% if request.url.path == '/admin/events' %}
                        No events of this type found. Use the form above to create some!
                    {% else %}
                        No events found in this category.
                    {% endif %}
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>