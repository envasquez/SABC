<!-- Past events table -->
<div class="table-responsive">
    <table class="table table-sm table-dark mb-0">
        <thead>
            <tr>
                <th width="12%">Date</th>
                <th width="8%">Type</th>
                <th width="25%">Name</th>
                <th width="25%">Description</th>
                <th width="12%">Tournament</th>
                <th width="10%">Results</th>
                <th width="8%" class="text-end">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% if past_events %}
            {% for event in past_events %}
            <tr>
                <td>
                    {{ event.date }}
                </td>
                <td>
                    {% if event.event_type == 'sabc_tournament' %}
                        <span class="badge bg-primary"><i class="bi bi-trophy"></i></span>
                    {% elif event.event_type == 'holiday' %}
                        <span class="badge bg-info"><i class="bi bi-calendar-heart"></i></span>
                    {% elif event.event_type == 'other_tournament' %}
                        <span class="badge bg-warning"><i class="bi bi-calendar"></i></span>
                    {% elif event.event_type == 'club_event' %}
                        <span class="badge bg-secondary"><i class="bi bi-calendar-event"></i></span>
                    {% else %}
                        <span class="badge bg-light text-dark">{{ event.event_type[:4] }}</span>
                    {% endif %}
                </td>
                <td>
                    <strong>{{ event.name }}</strong>
                    {% if event.event_type == 'sabc_tournament' and event.entry_fee %}
                    <br><small class="text-secondary">${{ "%.2f"|format(event.entry_fee) }}</small>
                    {% endif %}
                </td>
                <td>
                    {{ event.description }}
                    {% if event.event_type == 'sabc_tournament' %}
                        {% if event.lake_name %}
                        <br><small class="text-secondary"><i class="bi bi-geo-alt"></i> {{ event.lake_name }}</small>
                        {% endif %}
                        {% if event.start_time %}
                        <br><small class="text-secondary"><i class="bi bi-clock"></i> {{ event.start_time }} - {{ event.weigh_in_time or '15:00' }}</small>
                        {% endif %}
                    {% elif event.event_type == 'holiday' %}
                        <br><small class="text-info">{{ event.holiday_name }}</small>
                    {% endif %}
                </td>
                <td>
                    {% if event.event_type == 'sabc_tournament' %}
                        {% if event.tournament_complete %}
                            <span class="badge bg-success">Complete</span>
                        {% elif event.has_tournament %}
                            <span class="badge bg-warning">Incomplete</span>
                        {% else %}
                            <span class="badge bg-secondary">None</span>
                        {% endif %}
                    {% else %}
                        <span class="badge bg-secondary">N/A</span>
                    {% endif %}
                </td>
                <td>
                    {% if event.has_results %}
                        <span class="badge bg-success">Yes</span>
                    {% else %}
                        <span class="badge bg-secondary">No</span>
                    {% endif %}
                </td>
                <td class="text-end">
                    {% if event.has_results %}
                    <button class="btn btn-secondary btn-sm" disabled 
                            title="Cannot delete: Tournament has results">
                        <i class="bi bi-lock"></i>
                    </button>
                    {% else %}
                    <button class="btn btn-danger btn-sm delete-past-event" 
                            data-event-id="{{ event.id }}" 
                            data-event-name="{{ event.name }}" 
                            data-has-deps="{{ (event.has_poll or (event.has_tournament and not event.has_results))|tojson }}">
                        <i class="bi bi-trash"></i>
                    </button>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
            {% else %}
            <tr>
                <td colspan="7" class="text-center text-secondary py-4">
                    No past events found on this page.
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<!-- Past Events Pagination (if needed) -->
{% if past_total_pages > 1 %}
<div class="card-footer">
    <nav aria-label="Past events pagination">
        <ul class="pagination pagination-sm justify-content-center mb-0">
            {% if past_has_prev %}
                <li class="page-item">
                    <a class="page-link" href="/admin/events?upcoming_page={{ upcoming_page }}&past_page={{ past_prev_page }}">Previous</a>
                </li>
            {% else %}
                <li class="page-item disabled">
                    <span class="page-link">Previous</span>
                </li>
            {% endif %}
            
            {% for page_num in range(1, past_total_pages + 1) %}
                {% if page_num == past_page %}
                    <li class="page-item active">
                        <span class="page-link">{{ page_num }}</span>
                    </li>
                {% elif page_num <= 3 or page_num > past_total_pages - 3 or (page_num >= past_page - 2 and page_num <= past_page + 2) %}
                    <li class="page-item">
                        <a class="page-link" href="/admin/events?upcoming_page={{ upcoming_page }}&past_page={{ page_num }}">{{ page_num }}</a>
                    </li>
                {% elif page_num == 4 and past_page > 6 %}
                    <li class="page-item disabled">
                        <span class="page-link">â€¦</span>
                    </li>
                {% elif page_num == past_total_pages - 3 and past_page < past_total_pages - 5 %}
                    <li class="page-item disabled">
                        <span class="page-link">â€¦</span>
                    </li>
                {% endif %}
            {% endfor %}
            
            {% if past_has_next %}
                <li class="page-item">
                    <a class="page-link" href="/admin/events?upcoming_page={{ upcoming_page }}&past_page={{ past_next_page }}">Next</a>
                </li>
            {% else %}
                <li class="page-item disabled">
                    <span class="page-link">Next</span>
                </li>
            {% endif %}
        </ul>
        <div class="text-center mt-2">
            <small class="text-secondary">
                Showing page {{ past_page }} of {{ past_total_pages }} 
                ({{ total_past }} past events)
            </small>
        </div>
    </nav>
</div>
{% endif %}